
<div class="main-grid">
    <section class="bread-crumb">
        <div class="d-flex bet bottom">
             <app-hrm-breadcrumb [displayTitle]="true" [items]="items" [title]="'Công thức lương'"></app-hrm-breadcrumb>
             <div class="d-flex bet mid bottom gap-12">
                <p-button styleClass="p-button-sm " >
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13.6667 8.08835H8.08848V13.6666H5.91161V8.08835H0.333374V5.91148H5.91161V0.333252H8.08848V5.91148H13.6667V8.08835Z" fill="#F6FBFF"/>
                    </svg>
                    &nbsp;
                    Thêm mới
                </p-button>
                <p-button styleClass="p-button-sm  btn-dele" >
                    <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.1663 5.91658V14.2499H2.83301V5.91658H11.1663ZM9.91634 0.083252H4.08301L3.24967 0.916585H0.333008V2.58325H13.6663V0.916585H10.7497L9.91634 0.083252ZM12.833 4.24992H1.16634V14.2499C1.16634 15.1666 1.91634 15.9166 2.83301 15.9166H11.1663C12.083 15.9166 12.833 15.1666 12.833 14.2499V4.24992Z" fill="#F6FBFF"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M4.49967 12.1666V7.58325H6.16634V12.1666H4.49967Z" fill="#F6FBFF"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.83301 12.1666V7.58325H9.49967V12.1666H7.83301Z" fill="#F6FBFF"/>
                    </svg>
                    &nbsp;
                    Xóa
                </p-button>
                <p-button styleClass="p-button-sm " >
                    <svg width="16" height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13.8333 9.49992V12.8333H2.16667V9.49992H0.5V14.4999H15.5V9.49992H13.8333ZM8.83333 7.55825L10.9917 5.40825L12.1667 6.58325L8 10.7499L3.83333 6.58325L5.00833 5.40825L7.16667 7.55825V0.333252H8.83333V7.55825Z" fill="#F6FBFF"/>
                    </svg>
                    &nbsp;
                    Cập nhật
                </p-button>
                <p-button styleClass="p-button-sm " >
                    <svg width="14" height="20" viewBox="0 0 14 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.99992 4.99992V7.49992L10.3333 4.16658L6.99992 0.833252V3.33325C3.31659 3.33325 0.333252 6.31658 0.333252 9.99992C0.333252 11.3083 0.716585 12.5249 1.36659 13.5499L2.58325 12.3333C2.20825 11.6416 1.99992 10.8416 1.99992 9.99992C1.99992 7.24158 4.24159 4.99992 6.99992 4.99992ZM12.6333 6.44992L11.4166 7.66658C11.7833 8.36658 11.9999 9.15825 11.9999 9.99992C11.9999 12.7583 9.75825 14.9999 6.99992 14.9999V12.4999L3.66659 15.8333L6.99992 19.1666V16.6666C10.6833 16.6666 13.6666 13.6833 13.6666 9.99992C13.6666 8.69158 13.2833 7.47492 12.6333 6.44992Z" fill="#F6FBFF"/>
                    </svg>
                    &nbsp;
                    Import 
                </p-button>
                <!-- <p-button styleClass="p-button-sm " (click)="cauhinh()">
                    <svg width="20" height="17" viewBox="0 0 20 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 17V0H0.50855L0.5 17H19.5ZM6.675 15.3187H2.21V6.81868H6.675V15.3187ZM8.575 15.3187V6.81868H17.79V15.3187H8.575ZM2.21 1.68132V5.13736H17.79V1.68132H2.21Z" fill="#F3F8FF"/>
                    </svg>
                    &nbsp;
                    Cấu hình
                </p-button> -->
             </div>
        </div>
    </section>
    <section class="bread-filter d-flex bet bottom">
        <div class="col-item">
            <div class="d-flex align-items-center">
                <div class="filter filter-search">
                    <div class="fields search mb-0" [ngClass]=" query.filter ? 'valid' : 'invalid' ">
                        <input class="input-default" placeholder="Tìm kiếm" type="text" autocomplete="off" id="filter"
                             (keydown.enter)="query.offSet = 0; first = 0;load()"
                            [(ngModel)]="query.filter">
                            <span class="placeholder-icon" (click)="query.offSet = 0; first = 0; load()">
                                <svg width="19" height="20" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M9.02893 0.850098C4.51087 0.850098 0.849609 4.51552 0.849609 9.03539C0.849609 13.5553 4.51087 17.2207 9.02893 17.2207C10.8456 17.2207 12.5254 16.6271 13.8828 15.6241L17.1276 18.8716C17.4984 19.2427 18.0999 19.243 18.4711 18.8721C18.8422 18.5013 18.8425 17.8998 18.4716 17.5286L15.2709 14.3252C16.4787 12.8991 17.2083 11.0518 17.2083 9.03539C17.2083 4.51552 13.547 0.850098 9.02893 0.850098ZM2.74961 9.03539C2.74961 5.56338 5.56169 2.7501 9.02893 2.7501C12.4962 2.7501 15.3083 5.56338 15.3083 9.03539C15.3083 10.8568 14.5355 12.496 13.2976 13.645C12.1765 14.6858 10.6778 15.3207 9.02893 15.3207C5.56169 15.3207 2.74961 12.5074 2.74961 9.03539Z" fill="#2B2F33" fill-opacity="0.6"/>
                                    </svg>
                            </span>
                    </div>
                </div>
                
            </div>
        </div>
        <div class="d-flex bet end bottom gap-16">
            <div class="col-item">
                <div class="fields mb-0">
                    <p-dropdown appendTo="body" [baseZIndex]="100" [autoDisplayFirst]="false"
                    [options]="employeeStatus" [(ngModel)]="query.emp_st" name="emp_st"
                    (onChange)="find()" [filter]="true">
                    <ng-template let-item pTemplate="selectedItem">
                        <span>{{item.label}}</span>
                    </ng-template>
                    <ng-template let-car pTemplate="item">
                        <div class="ui-helper-clearfix" style="position: relative;height: 25px;">
                            <div>{{car.label}}</div>
                        </div>
                    </ng-template>
                    </p-dropdown>
                </div>
            </div>
            <div class="col-item">
                <div class=" d-flex end middle gap-16">
                    <p-button styleClass="reloadBtn hidden" (click)="query.offSet = 0;query.filter='';query.emp_st = -1; first = 0; load()">
                        <svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M8.89128 1.80952C5.00096 1.80952 1.81817 5.01267 1.81817 9C1.81817 12.9873 5.00096 16.1905 8.89128 16.1905C11.1061 16.1905 13.087 15.1561 14.3877 13.526C14.7 13.1346 15.2718 13.0693 15.665 13.3801C16.0582 13.6908 16.1238 14.2599 15.8116 14.6513C14.1855 16.6891 11.6915 18 8.89128 18C3.9647 18 0 13.9544 0 9C0 4.04557 3.9647 0 8.89128 0C12.8587 0 16.2024 2.62369 17.3539 6.23284L18.2926 4.51929C18.5329 4.08057 19.0851 3.91882 19.5259 4.15801C19.9667 4.39719 20.1292 4.94675 19.8889 5.38547L17.6716 9.43309C17.5446 9.66497 17.3221 9.83003 17.0626 9.88497C16.803 9.93991 16.5323 9.87923 16.3215 9.71886L12.7738 7.02045C12.3749 6.71703 12.2987 6.14921 12.6035 5.75219C12.9084 5.35518 13.4789 5.2793 13.8778 5.58273L15.6726 6.94784C14.8021 3.96847 12.0851 1.80952 8.89128 1.80952Z" fill="#BDC4D8"/>
                        </svg>
                    </p-button>
                    <p-button styleClass="p-button-sm btn-option">
                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0 14V16H6V14H0ZM0 2V4H10V2H0ZM10 18V16H18V14H10V12H8V18H10ZM4 6V8H0V10H4V12H6V6H4ZM18 10V8H8V10H18ZM12 6H14V4H18V2H14V0H12V6Z" fill="#76809B"/>
                        </svg>
                        <span class="dot"></span>
                    </p-button>
                    <p-button type="button" styleClass="box-icon" (click)="menuButton.toggle($event)" icon="uni-icon uni-dots" label=""></p-button>
                        
                    <p-button
                    styleClass="p-button-sm  ">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M6.10199 10.0001C6.10199 7.84533 7.84722 6.1001 10.002 6.1001C12.1568 6.1001 13.902 7.84533 13.902 10.0001C13.902 12.1549 12.1568 13.9001 10.002 13.9001C7.84722 13.9001 6.10199 12.1549 6.10199 10.0001ZM7.90199 10.0001C7.90199 11.1553 8.84676 12.1001 10.002 12.1001C11.1572 12.1001 12.102 11.1553 12.102 10.0001C12.102 8.84487 11.1572 7.9001 10.002 7.9001C8.84676 7.9001 7.90199 8.84487 7.90199 10.0001Z" fill="#F3F8FF"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.3328 10.9677L17.3257 11.0239L19.4802 12.7087C19.6292 12.8265 19.6721 13.0416 19.5748 13.2212L17.5754 16.68L17.5748 16.6811C17.5036 16.8078 17.368 16.8801 17.232 16.8801C17.1842 16.8801 17.1358 16.8723 17.0864 16.8561L14.547 15.8363L14.502 15.8701C13.9872 16.2562 13.4345 16.5915 12.8341 16.8376L12.7811 16.8593L12.393 19.5659L12.3928 19.5677C12.3693 19.7551 12.2042 19.9001 12.002 19.9001H8.00199C7.79981 19.9001 7.63464 19.7551 7.61124 19.5677L7.22286 16.8593L7.16991 16.8376C6.56875 16.5912 6.01644 16.2658 5.50296 15.8708L5.45771 15.836L2.91485 16.8573C2.87884 16.8717 2.83184 16.8801 2.78199 16.8801C2.63486 16.8801 2.4999 16.8068 2.42916 16.6811L0.429221 13.2212C0.331903 13.0416 0.37495 12.8264 0.523956 12.7086L2.67825 11.0239L2.67122 10.9677C2.63148 10.6497 2.60199 10.3243 2.60199 10.0001C2.60199 9.67591 2.63148 9.35045 2.67122 9.0325L2.67825 8.97625L0.523811 7.29149C0.371682 7.17128 0.32503 6.95535 0.428568 6.78014L2.42857 3.32015L2.42915 3.31912C2.50042 3.19243 2.63599 3.1201 2.77199 3.1201C2.81979 3.1201 2.86823 3.12789 2.91764 3.14406L5.45696 4.16387L5.50199 4.1301C6.01682 3.74398 6.56946 3.40872 7.16991 3.16263L7.22286 3.14093L7.611 0.434295L7.61122 0.432501C7.63464 0.245098 7.79981 0.100098 8.00199 0.100098H12.002C12.2042 0.100098 12.3693 0.2451 12.3927 0.432503L12.7811 3.14093L12.8341 3.16263C13.4352 3.40901 13.9875 3.73438 14.501 4.12936L14.5463 4.16417L17.0891 3.14295C17.1251 3.12854 17.1721 3.1201 17.222 3.1201C17.3691 3.1201 17.5041 3.19335 17.5748 3.31913L19.5748 6.779C19.6721 6.95858 19.6291 7.17383 19.48 7.29161L17.3257 8.97625L17.3328 9.0325C17.3725 9.35055 17.402 9.66597 17.402 10.0001C17.402 10.3342 17.3725 10.6496 17.3328 10.9677ZM15.2644 5.79743L14.2575 6.20588L13.393 5.54083L13.392 5.5401C12.9857 5.23541 12.5786 5.0012 12.1406 4.81785L11.133 4.40909L10.7789 1.9001H9.21572L9.00298 3.33608L8.85105 4.40907L7.84369 4.81772C7.42462 4.99148 7.00691 5.23644 6.57171 5.56031L5.71691 6.20616L4.72926 5.8073L3.37883 5.265L2.59177 6.6255L3.7406 7.51903L4.58581 8.18381L4.45272 9.2578L4.45249 9.26015C4.42253 9.5597 4.40199 9.79442 4.40199 10.0001C4.40199 10.2057 4.42249 10.4405 4.45242 10.7497L4.58581 11.8264L3.74017 12.4915L2.59177 13.3847L3.37883 14.7452L4.72958 14.2028L5.73646 13.7943L6.60102 14.4594L6.60199 14.4601C7.00825 14.7648 7.41539 14.999 7.85338 15.1823L8.86102 15.5911L9.21511 18.1001H10.7883L11.001 16.6641L11.1529 15.5911L12.1603 15.1825C12.5794 15.0087 12.9971 14.7638 13.4323 14.4399L14.2871 13.794L15.2747 14.1929L16.6252 14.7352L17.4122 13.3747L16.2634 12.4812L15.4182 11.8164L15.5513 10.7424L15.5515 10.74C15.5814 10.4406 15.602 10.2158 15.602 10.0001C15.602 9.78595 15.5917 9.57141 15.5512 9.2573L15.4182 8.18381L16.2642 7.5184L17.4018 6.61472L16.6152 5.255L15.2644 5.79743Z" fill="#F3F8FF"/>
                    </svg>
                    &nbsp; Tùy chỉnh
                  </p-button>
                    
                </div>
            </div>
        </div>
    </section>
    <p-menu [model]="itemsToolOfGrid" [appendTo]="'body'" [popup]="true"
    styleClass="menu-option-right" #menuButton></p-menu>
    <section class="content">
        <div class="grid-default" #container>
            <app-list-grid-angular *ngIf="columnDefs.length > 0" 
                [listsData]="listsData" 
                [height]="heightGrid"
                [columnDefs]="columnDefs"
                [rowSelection]="'multiple'"
                [floatingFilter]="true"
                >
            </app-list-grid-angular>
            <div class="paginator">
                <span>Từ {{ countRecord.currentRecordStart }} đến
                    {{ countRecord.currentRecordEnd }}
                    trên tổng số
                    {{ countRecord.totalRecord }} kết quả</span>
                <p-paginator [rows]="query.pageSize" [totalRecords]="countRecord.totalRecord" [first]="first"
                    (onPageChange)="paginate($event)" [rowsPerPageOptions]="[20,40,60,100,200,{ showAll: 'ALL' }]">
                </p-paginator>
            </div>
        </div>
    </section>
</div>


<p-sidebar
    [style]="{ width: '80%' }"
    [(visible)]="isTheOrganToMove" 
    position="right">
    <ng-template pTemplate="header">
        <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.41 0L0 1.41L4.58 6L0 10.59L1.41 12L7.41 6L1.41 0Z" fill="#2B2F33"/>
            <path d="M8 0L6.59 1.41L11.17 6L6.59 10.59L8 12L14 6L8 0Z" fill="#2B2F33"/>
        </svg> &nbsp;&nbsp;
        Chuyển tổ chức </ng-template>
    <ng-template pTemplate="footer"></ng-template>
    <div class="grid ">
        <div class="col-4">
            <div class="fields mb-0 label-8" [ngClass]="organizeId? 'valid': 'invalid' ">
                <label>Tổ chức</label>
                <p-dropdown appendTo="body" [baseZIndex]="100" [autoDisplayFirst]="false" (onChange)="getOrganizeTree()"
                    [options]="organs" [(ngModel)]="organizeId" name="organizeId" [filter]="true"
                    placeholder="Chọn tổ chức"
                    >
                    <ng-template let-item pTemplate="selectedItem">
                        <span style="vertical-align:middle;">{{item?.label}}</span>
                    </ng-template>
                    <ng-template let-car pTemplate="item">
                        <div class="ui-helper-clearfix" style="position: relative;height: 25px;">
                        <div style="font-size:14px;float:right;margin-top:4px">{{car?.label}}</div>
                        </div>
                    </ng-template>
                </p-dropdown>
            </div>
        </div>
        <div class="col-4">
            <div class="fields mb-0 label-8">
                <label>Bộ phận</label>
                <p-treeSelect  [filterInputAutoFocus]="true" [filter]="true" [metaKeySelection]="false"
                    [(ngModel)]="aDepartment" 
                    [ngClass]="[ departmentFiltes.length <= 0 ? 'tree-empty' : '' ]" 
                    [options]="departmentFiltes" 
                    selectionMode="single" 
                    name="aDepartment"
                    (onNodeSelect)="onChangeTreeDepart($event)"
                    placeholder="Chọn phòng ban">
                </p-treeSelect>
            </div>
        </div>
        <div class="col-12">
            <div class="grid-default">
                <app-list-grid-angular *ngIf="columnDefsMoveOrgan.length > 0" 
                    [listsData]="theOrganToMoveData" 
                    [height]="500"
                    [idGrid]="'theOrganToMoveData'"
                    [domLayout]="'autoHeight'" 
                    [columnDefs]="columnDefsMoveOrgan"
                    [rowSelection]="'multiple'"
                    >
                </app-list-grid-angular>
            </div>
        </div>
    </div>
</p-sidebar>

<p-sidebar
    [style]="{ width: '80%' }"
    styleClass="hr-diagram"
    [(visible)]="isHrDiagram" 
    position="right">
    <ng-template pTemplate="header">
        <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.41 0L0 1.41L4.58 6L0 10.59L1.41 12L7.41 6L1.41 0Z" fill="#2B2F33"/>
            <path d="M8 0L6.59 1.41L11.17 6L6.59 10.59L8 12L14 6L8 0Z" fill="#2B2F33"/>
        </svg> &nbsp;&nbsp;
        Lọc nhân sự theo sơ đồ tổ chức </ng-template>
    <ng-template pTemplate="footer"></ng-template>
    <p-organizationChart  [value]="listAgencyMap" *ngIf="isHrDiagram" styleClass="diagram-zindex" [preserveSpace]="false" selectionMode="single"
        [(selection)]="selectedNode" (onNodeSelect)="onNodeSelect($event)" styleClass="company">
        <ng-template let-node pTemplate="person">
            <div class="node-header p-corner-top">{{node.data.position ? node.data.position : 'No position'}}
            </div>
            <div class="node-content">
                <img src="{{node.data.avatarUrl ? node.data.avatarUrl : '../../../../../assets/images/img_avatar.png'}}"
                    width="32">
                <div>{{node.data.full_name ? node.data.full_name : 'No name'}}</div>
            </div>
        </ng-template>
        <ng-template let-node pTemplate="department">
            {{node.label}}
        </ng-template>
    </p-organizationChart>
</p-sidebar>

<!-- <p-dialog header="Cài đặt cấu hình" [(visible)]="displaySetting" (onHide)="find()" [modal]="true" [style]="{width: '50vw'}" [maximizable]="true"
[draggable]="false" [resizable]="false" [focusTrap]="false" styleClass="popup-setting">
<app-config-grid-table-form *ngIf="displaySetting && gridKey" [typeConfig]="'TableInfo'"   [gridKey]="gridKey"></app-config-grid-table-form>
</p-dialog> -->